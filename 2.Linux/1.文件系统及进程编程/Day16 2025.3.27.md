 *记录时间：2025年3月27日*

---

# 2025年3月27日 Linux 学习笔记

## 一. Linux 发展历史

### 1. Unix 早于 Linux

- **Unix**：
    
    - 起源：1969年，由贝尔实验室的Ken Thompson和Dennis Ritchie等人开发。
        
    - 特点：功能强大的多用户、多任务操作系统，奠定了现代操作系统基础。
        
- **Linux**：
    
    - 起源：1991年，由Linus Torvalds创建，受Minix（一个教学用Unix-like系统）启发。
        
    - 特点：自由软件，遵循GPL（GNU General Public License）许可证。
        

### 2. POSIX 标准

- **定义**：POSIX（Portable Operating System Interface，可移植操作系统接口），由IEEE制定，旨在提高Unix-like系统兼容性。
    
- **作用**：定义标准API、命令行Shell和实用程序接口，确保程序在POSIX兼容系统间的可移植性。
    
- **Linux与POSIX**：Linux遵循POSIX标准，POSIX兼容程序可在Linux及其他Unix-like系统运行。
    
- **非强制性**：POSIX是推荐标准，操作系统可选择是否完全实现。
    
- **POSIX-C**：
    
    - 定义：POSIX标准定义的C语言API，专为Unix-like系统设计。
        
    - 适用性：在Linux上有效，Windows需借助兼容层（如Cygwin）。
        
- **与ISO-C的区别**：
    
    - **ISO-C**：国际标准C语言，跨平台通用，适用于Linux、Windows等。
        
    - **POSIX-C**：扩展ISO-C，提供系统交互功能，适用于Linux等Unix-like系统。
        
    - 学习建议：ISO-C为基础，Linux开发阶段学习POSIX-C以满足系统级需求。
        

### 3. Linux 发行版

- **Ubuntu**：
    
    - 特点：用户友好，提供丰富的图形化工具和社区支持。
        
    - 适用：桌面用户和初学者。
        
- **CentOS**：
    
    - 特点：基于Red Hat Enterprise Linux（RHEL），免费，稳定且支持长期更新。
        
    - 适用：服务器操作系统。
        
- **其他发行版**：
    
    - **Debian**：以稳定性著称，Ubuntu基于其开发。
        
    - **Fedora**：由Red Hat赞助，注重前沿技术。
        
    - **Arch Linux**：滚动更新，高度自定义，适合高级用户。
        

### 4. GNU 项目

- 起源：1983年由Richard Stallman发起。
    
- 目标：开发完全自由的Unix-like操作系统。
    
- 贡献：Linux内核与GNU工具（如GCC编译器、glibc库）结合，形成**GNU/Linux**系统。
    

### 5. 自由软件与开源软件

- **自由软件**：用户可自由使用、修改和分发，Linux遵循GPL。
    
- **开源软件**：强调开发模式的优势，Linux同时符合自由软件和开源软件理念。
    

---

## 二. 内核和系统调用

### 1. 内核的作用

- **定义**：内核是操作系统的核心，管理所有硬件资源。
    
- **主要功能**：
    
    1. **文件管理系统**：管理文件存储、访问和权限。
        
    2. **外部设备管理**：控制磁盘、打印机等设备。
        
    3. **进程和线程管理**：调度和管理进程/线程。
        
    4. **内存管理**：分配/释放内存，管理虚拟内存和分页。
        
    5. **网络管理**：处理网络通信和协议栈。
        
    6. **安全和权限管理**：控制用户和进程的资源访问权限。
        

### 2. 系统调用

- **定义**：用户程序与内核交互的接口，用于请求特权操作（如打开文件、分配内存）。
    
- **特点**：
    
    - 涉及用户态到内核态切换，开销较大，性能较低。
        
    - 所有涉及内核的操作均需通过系统调用。
        
- **优化建议**：减少不必要的系统调用以提升性能。
    
- **常见示例**：
    
    - `open()`：打开文件。
        
    - `fork()`：创建进程。
        
    - `malloc()`：底层依赖系统调用分配内存。
        

### 3. ISO-C、POSIX-C 与系统调用的关系

- **ISO-C**：标准C语言API，跨平台，功能有限。
    
- **POSIX-C**：封装系统调用，提供丰富系统交互功能。
    
- **系统调用**：Linux内核底层接口，通常由POSIX-C或库函数封装。
    
- **选择原则**：
    
    1. **优先ISO-C**：确保跨平台兼容性。
        
    2. **POSIX-C**：Linux特有功能，兼顾兼容性。
        
    3. **系统调用**：直接调用内核接口，适用于特殊需求或极致性能，但牺牲可移植性。
        

---

## 三. 命令

### 1. man 命令

- **作用**：查看命令、函数、系统调用等的帮助文档。
    
- **用法**：
    
    - `man ls`：查看`ls`命令帮助。
        
    - `man 2 open`：查看`open`系统调用帮助（`2`表示系统调用）。
        
    - `man 3 printf`：查看`printf`库函数帮助（`3`表示库函数）。
        
- **帮助文档分区**：
    
    1. 用户命令（如`ls`、`cd`）。
        
    2. 系统调用（如`open`、`fork`）。
        
    3. 库函数（如`printf`、`strlen`）。
        
    4. 设备文件。
        
    5. 文件格式（如配置文件）。
        
    6. 游戏。
        
    7. 杂项。
        
    8. 系统管理命令（如`passwd`）。
        
- **结构**：
    
    - **NAME**：名称。
        
    - **SYNOPSIS**：头文件和函数声明。
        
    - **DESCRIPTION**：详细描述。
        
    - **RETURN**：返回值含义。
        
- **技巧**：通过`man`快速查阅用法和细节。
    

### 2. 其他常用命令

- **文件操作**：
    
    - `ls`：列出目录内容（类似Windows的`dir`）。
        
    - `cp`：复制文件。
        
    - `mv`：移动或重命名文件。
        
    - `rm`：删除文件。
        
- **进程管理**：
    
    - `ps`：查看进程。
        
    - `top`：实时监控进程。
        
    - `kill`：终止进程。
        
- **网络工具**：
    
    - `ping`：测试网络连通性。
        
    - `ip`：配置网络接口（替代`ifconfig`）。
        
- **权限管理**：
    
    - `chmod`：修改文件权限。
        
    - `chown`：更改文件所有者。
        

---

## 四. 补充知识点

### 1. Shell

- **定义**：用户与Linux交互的接口，解析并执行命令。
    
- **常见Shell**：
    
    - **bash**：默认Shell，广泛使用。
        
    - **zsh**：功能强大，支持插件。
        
    - **fish**：用户友好，注重交互体验。
        

### 2. 文件系统层次结构

- **结构**：树状结构，根目录为`/`。
    
- **重要目录**：
    
    - `/bin`：基本命令二进制文件。
        
    - `/etc`：配置文件。
        
    - `/home`：用户主目录。
        
    - `/var`：日志等可变数据。
        
    - `/usr`：用户程序和数据。
        

### 3. 包管理

- **作用**：管理软件安装、更新和卸载。
    
- **工具**：
    
    - Ubuntu/Debian：`apt`。
        
    - CentOS/RHEL：`yum`（旧）或`dnf`（新）。
        
    - Arch Linux：`pacman`。
        

### 4. 脚本编程

- **Shell脚本**：用bash等编写，自动化执行命令。
    
- **其他语言**：Python、Perl也常用于Linux脚本开发。
    

### 5. 用户子系统命令

- **特点**：
    
    1. 单个用户可多次同时登录同一台Linux机器。
        
    2. 多个用户也可多次同时登录。
        
- **用户类型**：
    
    - **root**：最高权限用户。
        
    - **sudo**：赋予普通用户临时最高权限。
        
- **激活root用户**：
    
    ```shell
    sudo passwd root  # 设置root密码
    su                # 切换到root用户
    ```
    
- **用户管理**：
    
    - 查看所有用户：
        
        ```shell
        cat /etc/passwd
        ```
        
    - 添加用户：
        
        ```shell
        sudo useradd test666           # 添加用户test666
        sudo passwd test666            # 设置密码
        sudo useradd -m test2          # 创建用户并生成家目录
        sudo useradd -m -s /bin/bash test3  # 指定bash作为默认Shell
        ```
        
    - 切换用户：
        
        ```shell
        su test1              # 切换到test1用户
        sudo su test2         # 以sudo切换到test2用户
        ```
        

### 6. Linux 注意事项

- 输入密码时无回显（无`*`或字符）。
    
- “无消息即成功”，有反馈通常表示出错，需查看反馈信息。
    

---

## 五. Linux 文件系统

### 特点

1. 树形结构管理文件系统（Windows为森林结构）。
    
2. 按类别存放文件。
    
3. Shell支持Tab键自动补全路径。
    
4. 上下键可调用历史命令。
    

### 重要文件夹

1. `/bin`：存储可执行程序和脚本。
    
2. `/etc`：配置文件。
    
3. `/lib`：系统库文件。
    
4. `/root`：root用户家目录。
    
5. `/home/{username}`：普通用户家目录。
    

---

## 六. 虚拟文件系统（VFS）

- **定义**：逻辑层，维护文件和目录的映射关系，与物理文件系统存储方式不同。
    
- **硬链接与软链接**：
    
    - **硬链接**：多个VFS文件映射到同一物理文件，共享数据。
        
        - 示例：创建`test1`目录（含`.`和`..`，硬链接数=2），在`test1`中创建`test2`（`test2`的`..`指向`test1`），硬链接数增至3。
            
    - **软链接**：类似快捷方式，指向另一文件或目录。
        

---

## 七. 文件操作命令

### 基本命令

- **创建目录**：
    
    ```shell
    mkdir dir_name  # 创建文件夹
    ```
    
- **查看路径**：
    
    ```shell
    pwd  # 显示当前绝对路径
    ```
    
- **切换目录**：
    
    ```shell
    cd ~            # 进入家目录
    cd cpp65        # 相对路径或绝对路径
    cd ..           # 上一级目录
    cd ../../..     # 上三级目录
    ```
    

### 文件操作

- **列出内容**：
    
    ```shell
    ls              # 当前文件夹内容
    ls /home/zhou   # 指定路径内容
    ls -a           # 显示所有文件（含隐藏）
    ls -al          # 详细列表（含权限）
    ```
    
- **复制**：
    
    ```shell
    cp test1.txt test2.txt   # 复制文件
    cp test1.txt dir/        # 复制到目录
    ```
    
- **删除**：
    
    ```shell
    rmdir dir_name   # 删除空目录
    rm test1.txt     # 删除文件
    rm -r dir        # 删除目录及其内容
    rm -rf dir       # 强制删除（慎用）
    rm -rf /         # 删除根目录（极度危险）
    ```
    

### Vim 超简单入门

- **模式**：
    
    - `i`：进入插入模式。
        
    - `Esc`：退出插入模式，进入普通模式。
        
- **命令**：
    
    - `:wq`：保存并退出。
        
    - `:q!`：强制退出不保存。
        

### 文件查看与搜索

- **查看文件内容**：
    
    ```shell
    cat file.txt  # 显示文件内容
    ```
    
- **查找文件**：
    
    ```shell
    find . -name "*.c"  # 按文件名查找C文件
    ```
    
- **搜索内容**：
    
    ```shell
    grep -nE "pattern" file.txt  # 搜索文件内容
    # -n：显示行号
    # -E：支持正则表达式
    ```
    

### 命令组合

- **分号**：顺序执行：
    
    ```shell
    cmd1 ; cmd2  # 先执行cmd1，再执行cmd2
    ```
    
- **管道**：将前者输出作为后者输入：
    
    ```shell
    cat file.txt | wc -l  # 统计行数
    ```
    

### 权限管理

- **修改权限**：
    
    ```shell
    chmod 755 file  # 设置文件权限（读写执行）
    ```