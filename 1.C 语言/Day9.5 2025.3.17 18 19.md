
---

# C 语言指针与相关知识总结（2025.3.17 - 2025.3.19）

## 一、指针与内存管理

### 1.1 指针基础（3月17日）

- **指针常量与常量指针**：
    
    - **常量指针**（`int *const p`）：指针不可变，可修改数据。
        
    - **指向常量的指针**（`const int *p`）：数据不可变，可改变指向。
        
    - **记忆**：`const` 修饰谁，谁不可变。
        
    - 示例：
        
        ```c
        int a = 10, b = 20;
        const int *p1 = &a;    // 数据不可变
        int *const p3 = &a;    // 指针不可变
        p1 = &b;              // 正确
        *p3 = 666;            // 正确
        ```
        
- **数组传递**：
    
    - 数组退化为指针，需额外传递长度。
        
    - 示例：
        
        ```c
        void func(int *p, int len) {
            for (int i = 0; i < len; i++) p[i] *= 2;
        }
        int main() {
            int arr[] = {1, 2, 3};
            func(arr, 3);
        }
        ```
        
- **指针运算**：
    
    - 指针加减按元素大小偏移（`int*` 加 1 偏移 4 字节）。
        
    - 示例（二维数组）：
        
        ```c
        int matrix[2][3] = {{1, 2, 3}, {4, 5, 6}};
        printf("%d\n", *(*(matrix + 1) + 2)); // 输出 6
        ```
        
- **指针返回值**：
    
    - 避免返回局部变量地址，使用静态变量或动态分配。
        
    - 示例：
        
        ```c
        int *test() {
            static int arr[3] = {1, 2, 3};
            return arr;
        }
        ```
        

### 1.2 存储期限（3月19日）

- **自动存储（栈）**：生命周期与函数一致，自动管理，空间小。
    
- **静态存储（数据段）**：生命周期与程序一致，适合全局变量。
    
- **动态存储（堆）**：手动分配释放，空间大但易出错。
    
- **建议**：优先栈 > 堆 > 数据段。
    

### 1.3 动态内存分配与释放（3月19日）

- **函数**（需 `#include` ）：
    
    - `malloc`：分配内存，未初始化。
        
    - `calloc`：分配并初始化为 0。
        
    - `realloc`：调整内存大小。
        
    - `free`：释放内存。
        
- **注意**：
    
    - 分配后检查 `NULL`。
        
    - 避免 `double free` 和野指针。
        
    - 示例：
        
        ```c
        int *p = (int *)malloc(5 * sizeof(int));
        if (p == NULL) return;
        for (int i = 0; i < 5; i++) p[i] = i;
        free(p);
        ```
        
- **最佳实践**：
    
    - 优先分配数组/结构体。
        
    - 备份原始指针，释放后置 `NULL`。
        

---

## 二、字符串与相关操作（3月17日、3月18日）

### 2.1 字符串基础

- **定义**：以 `\0` 结尾的字符数组。
    
- **存储**：
    
    - 字面值（`"hello"`）：只读数据段。
        
    - 字符数组（`char str[]`）：栈上，可修改。
        
- **示例**：
    
    ```c
    char str[] = "hello"; // 自动加 \0
    char *p = "world";    // 只读
    ```
    

### 2.2 字符串操作

- **输出**：
    
    - `puts(str)`：自动换行。
        
    - 循环：`while (*p != '\0') printf("%c", *p++);`
        
- **输入**：
    
    - `scanf("%s", str)`：以空格分隔，注意溢出。
        
    - 建议用 `fgets`。
        
- **字符串函数**（需 `#include` ）：
    
    - `strlen`：计算长度（不含 `\0`）。
        
    - `strcpy`/`strncpy`：复制。
        
    - `strcat`/`strncat`：拼接。
        
    - `strcmp`：比较。
        
    - 示例：
        
        ```c
        char src[] = "hello", dest[10];
        strncpy(dest, src, 3); // 复制 "hel"
        dest[3] = '\0';       // 手动加 \0
        ```
        
- **格式化**：
    
    - `sscanf`：从字符串读取数据。
        
    - `sprintf`：格式化到字符串。
        
    - 示例：
        
        ```c
        char str[] = "123 45.67";
        int num;
        double f;
        sscanf(str, "%d %lf", &num, &f); // num=123, f=45.67
        ```
        

### 2.3 字符串数组

- **二维字符数组**：空间浪费。
    
    ```c
    char days[][10] = {"Monday", "Tuesday"};
    ```
    
- **字符指针数组**：更灵活。
    
    ```c
    const char *days[] = {"Monday", "Tuesday"};
    ```
    

---

## 三、结构体与枚举（3月18日）

### 3.1 结构体

- **定义**：
    
    ```c
    typedef struct {
        int id;
        char name[20];
    } Student;
    ```
    
- **内存对齐**：按 4/8 字节对齐，`sizeof` 计算大小。
    
- **操作**：
    
    ```c
    Student s = {1, "张三"};
    Student *p = &s;
    p->id = 2; // 等价于 (*p).id
    ```
    
- **返回值**：返回副本安全，返回局部变量地址会导致悬空指针。
    

### 3.2 枚举

- **定义**：
    
    ```c
    typedef enum { RED, GREEN, BLUE } Color;
    ```
    
- **优点**：可读性强，底层为 `int`。
    

---

## 四、命令行参数（3月18日）

- **接收**：
    
    ```c
    int main(int argc, char *argv[]) {
        for (int i = 0; i < argc; i++) {
            printf("Arg %d: %s\n", i, argv[i]);
        }
    }
    ```
    
- **运行**：`./program arg1 arg2`
    

---

## 五、LeetCode 五步刷题法（3月18日）

1. **第一天**：理解题目，自力尝试，参考题解后重写。
    
2. **第二天**：复习重做，理解核心算法。
    
3. **第五天**：不看题解重写，优化代码。
    
4. **第十天**：快速回忆，默写代码。
    
5. **第二十天**：完全掌握，讲解题目。
    

- **建议**：分析复杂度，定期复习。
    

---

## 六
---

## 七、总结与建议

- **C 语言**：
    
    - 掌握指针、内存管理和字符串操作。
        
    - 动态内存分配需谨慎，优先栈，避免内存泄漏。
        
- **刷题**：五步法循序渐进，注重复杂度分析。
    

